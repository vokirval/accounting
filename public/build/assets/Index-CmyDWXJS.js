import{d as F,j as h,c as m,a as l,u as s,h as D,w as a,b as t,f as d,o as i,F as $,r as M,t as u,e as C,g as v,k as q,s as I,v as L,m as O,n as k,p as y,q as P}from"./app-6IuVRty4.js";import{_ as T}from"./AppLayout.vue_vue_type_script_setup_true_lang-BFnZQieK.js";import{_ as A}from"./index-DYrfZQ3R.js";import{_ as f}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DzCRWDpa.js";import{_ as g}from"./Input.vue_vue_type_script_setup_true_lang-BnOyNL43.js";import{_ as x}from"./Label.vue_vue_type_script_setup_true_lang-BrSu2rW5.js";import{_ as G,a as H,b as J,c as K}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CSWOw7Ia.js";import"./index-Rc_5eQgO.js";import"./VisuallyHidden-B9JSysNA.js";import"./useForwardExpose-jmm3fhLj.js";import"./useForwardPropsEmits-BaoshRru.js";import"./index-B26eXW15.js";import"./loader-circle-CluUrM1C.js";const Q={class:"flex flex-col gap-6 p-4"},R={class:"flex flex-wrap items-center justify-between gap-4"},W={class:"overflow-hidden rounded-xl border border-sidebar-border/70 bg-white dark:border-sidebar-border dark:bg-neutral-900"},X={class:"w-full text-left text-sm"},Y={class:"px-4 py-3"},Z={class:"px-4 py-3"},ee={class:"px-4 py-3"},se={class:"px-4 py-3"},te={class:"px-4 py-3"},re={class:"flex flex-wrap gap-2"},oe={key:0},le={class:"grid gap-2"},ae={key:0,class:"text-sm text-red-600"},ne={class:"grid gap-2"},de={key:0,class:"text-sm text-red-600"},ie={class:"grid gap-2"},ue={key:0,class:"text-sm text-red-600"},me={class:"grid gap-2"},pe={key:0,class:"text-sm text-red-600"},fe={class:"flex justify-end gap-2"},Ee=F({__name:"Index",setup(ce){const V=P(),w=O(()=>V.props),S=[{title:"Адмін",href:"/admin/users"},{title:"Користувачі",href:"/admin/users"}],p=k(!1),c=k(!1),_=k(null),r=h({name:"",email:"",role:"user",password:""}),U=()=>{c.value=!1,_.value=null,r.reset(),r.clearErrors(),p.value=!0},E=n=>{c.value=!0,_.value=n,r.name=n.name,r.email=n.email,r.role=n.role,r.password="",r.clearErrors(),p.value=!0},z=()=>{if(c.value&&_.value){if(!window.confirm("Підтвердити оновлення користувача?"))return;r.transform(e=>{const o={...e};return o.password||delete o.password,o}),r.put(`/admin/users/${_.value.id}`,{preserveScroll:!0,onSuccess:()=>{p.value=!1}});return}r.transform(n=>n),r.post("/admin/users",{preserveScroll:!0,onSuccess:()=>{p.value=!1,r.reset()}})},B=n=>{window.confirm("Заблокувати користувача?")&&y.patch(`/admin/users/${n.id}/block`,{},{preserveScroll:!0})},N=n=>{window.confirm("Розблокувати користувача?")&&y.patch(`/admin/users/${n.id}/unblock`,{},{preserveScroll:!0})},j=n=>{window.confirm("Видалити користувача?")&&y.delete(`/admin/users/${n.id}`,{preserveScroll:!0})};return(n,e)=>(i(),m($,null,[l(s(D),{title:"Користувачі"}),l(T,{breadcrumbs:S},{default:a(()=>[t("div",Q,[t("div",R,[e[7]||(e[7]=t("div",null,[t("h1",{class:"text-xl font-semibold"},"Користувачі"),t("p",{class:"text-sm text-muted-foreground"},"Керування користувачами лише для адміністратора.")],-1)),l(s(f),{onClick:U},{default:a(()=>[...e[6]||(e[6]=[d("Створити користувача",-1)])]),_:1})]),t("div",W,[t("table",X,[e[13]||(e[13]=t("thead",{class:"border-b border-sidebar-border/70 text-xs uppercase text-muted-foreground"},[t("tr",null,[t("th",{class:"px-4 py-3"},"Ім'я"),t("th",{class:"px-4 py-3"},"Email"),t("th",{class:"px-4 py-3"},"Роль"),t("th",{class:"px-4 py-3"},"Статус"),t("th",{class:"px-4 py-3"},"Дії")])],-1)),t("tbody",null,[(i(!0),m($,null,M(w.value.users,o=>(i(),m("tr",{key:o.id,class:"border-b border-sidebar-border/40"},[t("td",Y,u(o.name),1),t("td",Z,u(o.email),1),t("td",ee,u(o.role),1),t("td",se,[l(s(A),{variant:o.blocked_at?"destructive":"secondary"},{default:a(()=>[d(u(o.blocked_at?"Заблоковано":"Активний"),1)]),_:2},1032,["variant"])]),t("td",te,[t("div",re,[l(s(f),{size:"sm",variant:"outline",onClick:b=>E(o)},{default:a(()=>[...e[8]||(e[8]=[d("Редагувати",-1)])]),_:1},8,["onClick"]),o.blocked_at?(i(),C(s(f),{key:1,size:"sm",variant:"secondary",onClick:b=>N(o)},{default:a(()=>[...e[10]||(e[10]=[d(" Розблокувати ",-1)])]),_:1},8,["onClick"])):(i(),C(s(f),{key:0,size:"sm",variant:"secondary",onClick:b=>B(o)},{default:a(()=>[...e[9]||(e[9]=[d(" Заблокувати ",-1)])]),_:1},8,["onClick"])),l(s(f),{size:"sm",variant:"destructive",onClick:b=>j(o)},{default:a(()=>[...e[11]||(e[11]=[d("Видалити",-1)])]),_:1},8,["onClick"])])])]))),128)),w.value.users.length===0?(i(),m("tr",oe,[...e[12]||(e[12]=[t("td",{class:"px-4 py-6 text-center text-muted-foreground",colspan:"5"},"Користувачі відсутні.",-1)])])):v("",!0)])])])]),l(s(G),{open:p.value,"onUpdate:open":e[5]||(e[5]=o=>p.value=o)},{default:a(()=>[l(s(H),null,{default:a(()=>[l(s(J),null,{default:a(()=>[l(s(K),null,{default:a(()=>[d(u(c.value?"Редагувати користувача":"Створити користувача"),1)]),_:1})]),_:1}),t("form",{class:"mt-4 grid gap-4",onSubmit:q(z,["prevent"])},[t("div",le,[l(s(x),null,{default:a(()=>[...e[14]||(e[14]=[d("Ім'я",-1)])]),_:1}),l(s(g),{modelValue:s(r).name,"onUpdate:modelValue":e[0]||(e[0]=o=>s(r).name=o)},null,8,["modelValue"]),s(r).errors.name?(i(),m("span",ae,u(s(r).errors.name),1)):v("",!0)]),t("div",ne,[l(s(x),null,{default:a(()=>[...e[15]||(e[15]=[d("Email",-1)])]),_:1}),l(s(g),{modelValue:s(r).email,"onUpdate:modelValue":e[1]||(e[1]=o=>s(r).email=o),type:"email"},null,8,["modelValue"]),s(r).errors.email?(i(),m("span",de,u(s(r).errors.email),1)):v("",!0)]),t("div",ie,[l(s(x),null,{default:a(()=>[...e[16]||(e[16]=[d("Роль",-1)])]),_:1}),I(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>s(r).role=o),class:"h-9 rounded-md border border-input bg-transparent px-3 text-sm"},[...e[17]||(e[17]=[t("option",{value:"user"},"Користувач",-1),t("option",{value:"accountant"},"Бухгалтер",-1),t("option",{value:"admin"},"Адміністратор",-1)])],512),[[L,s(r).role]]),s(r).errors.role?(i(),m("span",ue,u(s(r).errors.role),1)):v("",!0)]),t("div",me,[l(s(x),null,{default:a(()=>[...e[18]||(e[18]=[d("Пароль",-1)])]),_:1}),l(s(g),{modelValue:s(r).password,"onUpdate:modelValue":e[3]||(e[3]=o=>s(r).password=o),type:"password",placeholder:c.value?"Залиште порожнім, щоб не змінювати":""},null,8,["modelValue","placeholder"]),s(r).errors.password?(i(),m("span",pe,u(s(r).errors.password),1)):v("",!0)]),t("div",fe,[l(s(f),{type:"button",variant:"ghost",onClick:e[4]||(e[4]=o=>p.value=!1)},{default:a(()=>[...e[19]||(e[19]=[d("Скасувати",-1)])]),_:1}),l(s(f),{type:"submit",disabled:s(r).processing},{default:a(()=>[...e[20]||(e[20]=[d("Зберегти",-1)])]),_:1},8,["disabled"])])],32)]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{Ee as default};
