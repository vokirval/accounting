import{d as X,H as z,c as d,a as r,u as t,h as Y,w as o,b as a,o as n,e as V,f as i,g as m,p as f,F as h,E as B,v as F,j,r as x,I as N,J as Z}from"./app-BE6QdeMr.js";import{_ as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-D2c59wsq.js";import{_ as te}from"./index-D3jlIiru.js";import{_ as c}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Dk4QiK2X.js";import{_ as U}from"./Input.vue_vue_type_script_setup_true_lang-B7WzRkgV.js";import{_ as T}from"./Label.vue_vue_type_script_setup_true_lang-DH01CRbA.js";import{_ as D,a as I,b as M,c as O}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CkescQCB.js";import"./index-BSn_kBxy.js";import"./VisuallyHidden-C267o_qF.js";import"./useForwardExpose-HElGGXL4.js";import"./useForwardPropsEmits-DTJkXGuD.js";import"./index-B26eXW15.js";import"./loader-circle-B1nvjyWE.js";const se={class:"flex flex-col gap-6 p-4"},re={class:"flex flex-wrap items-center justify-between gap-4"},oe={key:0,class:"rounded-md border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700 dark:border-red-900/50 dark:bg-red-950/40 dark:text-red-200"},ae={key:0},ne={key:1},le={class:"grid gap-4"},de={class:"flex flex-wrap items-center justify-between gap-3"},ie={class:"flex items-center gap-3"},ue={class:"text-base font-semibold"},pe={class:"flex flex-wrap gap-2"},me={class:"mt-3 flex flex-wrap items-center gap-2"},fe={key:0,class:"text-xs text-muted-foreground"},ce={key:1,class:"flex flex-wrap gap-2"},ve=["onClick"],_e=["onClick"],ge={key:0,class:"rounded-xl border border-sidebar-border/70 bg-white p-6 text-center text-sm text-muted-foreground dark:border-sidebar-border dark:bg-neutral-900"},xe={class:"grid gap-2"},be={key:0,class:"text-sm text-red-600"},ye={class:"flex justify-end gap-2"},ke={class:"grid gap-2"},Ce={key:0,class:"text-sm text-red-600"},$e={class:"flex justify-end gap-2"},Me=X({__name:"Index",setup(we){const q=Z(),k=j(()=>q.props),b=j(()=>k.value.errors??{}),E=j(()=>k.value.permissions.manage_types===!0),H=[{title:"Платіжні заявки",href:"/payment-requests"},{title:"Типи витрат",href:"/admin/expense-types"}],v=x(!1),C=x(!1),$=x(null),_=x(!1),w=x(!1),y=x(null),S=x(null),u=z({name:""}),p=z({name:""}),J=()=>{C.value=!1,$.value=null,u.reset(),u.clearErrors(),v.value=!0},L=l=>{C.value=!0,$.value=l,u.name=l.name,u.clearErrors(),v.value=!0},P=()=>{if(C.value&&$.value){if(!window.confirm("Підтвердити оновлення типу витрат?"))return;u.put(`/admin/expense-types/${$.value.id}`,{preserveScroll:!0,onSuccess:()=>{v.value=!1}});return}u.post("/admin/expense-types",{preserveScroll:!0,onSuccess:()=>{v.value=!1,u.reset()}})},A=l=>{window.confirm("Видалити тип витрат?")&&N.delete(`/admin/expense-types/${l.id}`,{preserveScroll:!0})},G=l=>{w.value=!1,y.value=l,S.value=null,p.reset(),p.clearErrors(),_.value=!0},K=(l,e)=>{w.value=!0,y.value=l,S.value=e,p.name=e.name,p.clearErrors(),_.value=!0},Q=()=>{if(y.value){if(w.value&&S.value){if(!window.confirm("Підтвердити оновлення категорії?"))return;p.put(`/admin/expense-types/${y.value.id}/categories/${S.value.id}`,{preserveScroll:!0,onSuccess:()=>{_.value=!1}});return}p.post(`/admin/expense-types/${y.value.id}/categories`,{preserveScroll:!0,onSuccess:()=>{_.value=!1,p.reset()}})}},R=(l,e)=>{window.confirm("Видалити категорію?")&&N.delete(`/admin/expense-types/${l.id}/categories/${e.id}`,{preserveScroll:!0})};return(l,e)=>(n(),d(h,null,[r(t(Y),{title:"Типи витрат"}),r(ee,{breadcrumbs:H},{default:o(()=>[a("div",se,[a("div",re,[e[7]||(e[7]=a("div",null,[a("h1",{class:"text-xl font-semibold"},"Типи витрат"),a("p",{class:"text-sm text-muted-foreground"},"Налаштування типів та категорій витрат.")],-1)),E.value?(n(),V(t(c),{key:0,size:"sm",onClick:J},{default:o(()=>[...e[6]||(e[6]=[i("Створити тип",-1)])]),_:1})):m("",!0)]),b.value.delete||b.value.delete_category?(n(),d("div",oe,[b.value.delete?(n(),d("p",ae,f(b.value.delete),1)):m("",!0),b.value.delete_category?(n(),d("p",ne,f(b.value.delete_category),1)):m("",!0)])):m("",!0),a("div",le,[(n(!0),d(h,null,B(k.value.items,s=>(n(),d("div",{key:s.id,class:"rounded-xl border border-sidebar-border/70 bg-white p-4 dark:border-sidebar-border dark:bg-neutral-900"},[a("div",de,[a("div",ie,[a("h2",ue,f(s.name),1),r(t(te),{variant:"outline",class:"text-[11px]"},{default:o(()=>[i("Категорії: "+f(s.categories.length),1)]),_:2},1024)]),a("div",pe,[E.value?(n(),V(t(c),{key:0,size:"sm",variant:"outline",onClick:g=>L(s)},{default:o(()=>[...e[8]||(e[8]=[i("Редагувати",-1)])]),_:1},8,["onClick"])):m("",!0),E.value?(n(),V(t(c),{key:1,size:"sm",variant:"destructive",onClick:g=>A(s)},{default:o(()=>[...e[9]||(e[9]=[i("Видалити",-1)])]),_:1},8,["onClick"])):m("",!0)])]),a("div",me,[r(t(c),{size:"sm",variant:"secondary",class:"h-7 px-2 text-[11px]",onClick:g=>G(s)},{default:o(()=>[...e[10]||(e[10]=[i(" Додати категорію ",-1)])]),_:1},8,["onClick"]),s.categories.length===0?(n(),d("div",fe," Категорії відсутні. ")):(n(),d("div",ce,[(n(!0),d(h,null,B(s.categories,g=>(n(),d("div",{key:g.id,class:"flex items-center gap-2 rounded-md border border-input px-2 py-1 text-[11px]"},[a("span",null,f(g.name),1),a("button",{type:"button",class:"text-muted-foreground hover:text-foreground",onClick:W=>K(s,g)}," Ред. ",8,ve),a("button",{type:"button",class:"text-red-600 hover:text-red-700",onClick:W=>R(s,g)}," Вид. ",8,_e)]))),128))]))])]))),128)),k.value.items.length===0?(n(),d("div",ge," Типи витрат відсутні. ")):m("",!0)])]),r(t(D),{open:v.value,"onUpdate:open":e[2]||(e[2]=s=>v.value=s)},{default:o(()=>[r(t(I),null,{default:o(()=>[r(t(M),null,{default:o(()=>[r(t(O),null,{default:o(()=>[i(f(C.value?"Редагувати тип":"Створити тип"),1)]),_:1})]),_:1}),a("form",{class:"mt-4 grid gap-4",onSubmit:F(P,["prevent"])},[a("div",xe,[r(t(T),null,{default:o(()=>[...e[11]||(e[11]=[i("Назва",-1)])]),_:1}),r(t(U),{modelValue:t(u).name,"onUpdate:modelValue":e[0]||(e[0]=s=>t(u).name=s)},null,8,["modelValue"]),t(u).errors.name?(n(),d("span",be,f(t(u).errors.name),1)):m("",!0)]),a("div",ye,[r(t(c),{type:"button",variant:"ghost",onClick:e[1]||(e[1]=s=>v.value=!1)},{default:o(()=>[...e[12]||(e[12]=[i("Скасувати",-1)])]),_:1}),r(t(c),{type:"submit",disabled:t(u).processing},{default:o(()=>[...e[13]||(e[13]=[i("Зберегти",-1)])]),_:1},8,["disabled"])])],32)]),_:1})]),_:1},8,["open"]),r(t(D),{open:_.value,"onUpdate:open":e[5]||(e[5]=s=>_.value=s)},{default:o(()=>[r(t(I),null,{default:o(()=>[r(t(M),null,{default:o(()=>[r(t(O),null,{default:o(()=>[i(f(w.value?"Редагувати категорію":"Створити категорію"),1)]),_:1})]),_:1}),a("form",{class:"mt-4 grid gap-4",onSubmit:F(Q,["prevent"])},[a("div",ke,[r(t(T),null,{default:o(()=>[...e[14]||(e[14]=[i("Назва",-1)])]),_:1}),r(t(U),{modelValue:t(p).name,"onUpdate:modelValue":e[3]||(e[3]=s=>t(p).name=s)},null,8,["modelValue"]),t(p).errors.name?(n(),d("span",Ce,f(t(p).errors.name),1)):m("",!0)]),a("div",$e,[r(t(c),{type:"button",variant:"ghost",onClick:e[4]||(e[4]=s=>_.value=!1)},{default:o(()=>[...e[15]||(e[15]=[i("Скасувати",-1)])]),_:1}),r(t(c),{type:"submit",disabled:t(p).processing},{default:o(()=>[...e[16]||(e[16]=[i("Зберегти",-1)])]),_:1},8,["disabled"])])],32)]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{Me as default};
