import{d as D,j as M,c as m,a as l,u as s,h as q,w as a,b as t,f as n,o as i,t as u,g as c,F as C,r as I,e as V,k as L,s as O,v as P,m as S,n as y,p as g,q as T}from"./app-vIeCO0mb.js";import{_ as A}from"./AppLayout.vue_vue_type_script_setup_true_lang-DeVz9zvs.js";import{_ as G}from"./index-C8Wp-btG.js";import{_ as f}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DA7aidpq.js";import{_ as w}from"./Input.vue_vue_type_script_setup_true_lang-BZwEdfVM.js";import{_ as x}from"./Label.vue_vue_type_script_setup_true_lang-DX3IeS9-.js";import{_ as H,a as J,b as K,c as Q}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BQnj50At.js";import"./index-BSTgUifH.js";import"./VisuallyHidden-RKA89y6Z.js";import"./useForwardExpose-CP0oZ6zC.js";import"./useForwardPropsEmits-z0oDnB_6.js";import"./index-B26eXW15.js";import"./loader-circle-JR_dS27q.js";const R={class:"flex flex-col gap-6 p-4"},W={class:"flex flex-wrap items-center justify-between gap-4"},X={key:0,class:"rounded-md border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700 dark:border-red-900/50 dark:bg-red-950/40 dark:text-red-200"},Y={class:"overflow-hidden rounded-xl border border-sidebar-border/70 bg-white dark:border-sidebar-border dark:bg-neutral-900"},Z={class:"w-full text-left text-sm"},ee={class:"px-4 py-3"},se={class:"px-4 py-3"},te={class:"px-4 py-3"},re={class:"px-4 py-3"},oe={class:"px-4 py-3"},le={class:"flex flex-wrap gap-2"},ae={key:0},de={class:"grid gap-2"},ne={key:0,class:"text-sm text-red-600"},ie={class:"grid gap-2"},ue={key:0,class:"text-sm text-red-600"},me={class:"grid gap-2"},pe={key:0,class:"text-sm text-red-600"},fe={class:"grid gap-2"},ce={key:0,class:"text-sm text-red-600"},ve={class:"flex justify-end gap-2"},Be=D({__name:"Index",setup(_e){const U=T(),b=S(()=>U.props),$=S(()=>b.value.errors??{}),E=[{title:"Адмін",href:"/admin/users"},{title:"Користувачі",href:"/admin/users"}],p=y(!1),v=y(!1),_=y(null),r=M({name:"",email:"",role:"user",password:""}),z=()=>{v.value=!1,_.value=null,r.reset(),r.clearErrors(),p.value=!0},B=d=>{v.value=!0,_.value=d,r.name=d.name,r.email=d.email,r.role=d.role,r.password="",r.clearErrors(),p.value=!0},N=()=>{if(v.value&&_.value){if(!window.confirm("Підтвердити оновлення користувача?"))return;r.transform(e=>{const o={...e};return o.password||delete o.password,o}),r.put(`/admin/users/${_.value.id}`,{preserveScroll:!0,onSuccess:()=>{p.value=!1}});return}r.transform(d=>d),r.post("/admin/users",{preserveScroll:!0,onSuccess:()=>{p.value=!1,r.reset()}})},h=d=>{window.confirm("Заблокувати користувача?")&&g.patch(`/admin/users/${d.id}/block`,{},{preserveScroll:!0})},j=d=>{window.confirm("Розблокувати користувача?")&&g.patch(`/admin/users/${d.id}/unblock`,{},{preserveScroll:!0})},F=d=>{window.confirm("Видалити користувача?")&&g.delete(`/admin/users/${d.id}`,{preserveScroll:!0})};return(d,e)=>(i(),m(C,null,[l(s(q),{title:"Користувачі"}),l(A,{breadcrumbs:E},{default:a(()=>[t("div",R,[t("div",W,[e[7]||(e[7]=t("div",null,[t("h1",{class:"text-xl font-semibold"},"Користувачі"),t("p",{class:"text-sm text-muted-foreground"},"Керування користувачами лише для адміністратора.")],-1)),l(s(f),{onClick:z},{default:a(()=>[...e[6]||(e[6]=[n("Створити користувача",-1)])]),_:1})]),$.value.user?(i(),m("div",X,[t("p",null,u($.value.user),1)])):c("",!0),t("div",Y,[t("table",Z,[e[13]||(e[13]=t("thead",{class:"border-b border-sidebar-border/70 text-xs uppercase text-muted-foreground"},[t("tr",null,[t("th",{class:"px-4 py-3"},"Ім'я"),t("th",{class:"px-4 py-3"},"Email"),t("th",{class:"px-4 py-3"},"Роль"),t("th",{class:"px-4 py-3"},"Статус"),t("th",{class:"px-4 py-3"},"Дії")])],-1)),t("tbody",null,[(i(!0),m(C,null,I(b.value.users,o=>(i(),m("tr",{key:o.id,class:"border-b border-sidebar-border/40"},[t("td",ee,u(o.name),1),t("td",se,u(o.email),1),t("td",te,u(o.role),1),t("td",re,[l(s(G),{variant:o.blocked_at?"destructive":"secondary"},{default:a(()=>[n(u(o.blocked_at?"Заблоковано":"Активний"),1)]),_:2},1032,["variant"])]),t("td",oe,[t("div",le,[l(s(f),{size:"sm",variant:"outline",onClick:k=>B(o)},{default:a(()=>[...e[8]||(e[8]=[n("Редагувати",-1)])]),_:1},8,["onClick"]),o.blocked_at?(i(),V(s(f),{key:1,size:"sm",variant:"secondary",onClick:k=>j(o)},{default:a(()=>[...e[10]||(e[10]=[n(" Розблокувати ",-1)])]),_:1},8,["onClick"])):(i(),V(s(f),{key:0,size:"sm",variant:"secondary",onClick:k=>h(o)},{default:a(()=>[...e[9]||(e[9]=[n(" Заблокувати ",-1)])]),_:1},8,["onClick"])),l(s(f),{size:"sm",variant:"destructive",onClick:k=>F(o)},{default:a(()=>[...e[11]||(e[11]=[n("Видалити",-1)])]),_:1},8,["onClick"])])])]))),128)),b.value.users.length===0?(i(),m("tr",ae,[...e[12]||(e[12]=[t("td",{class:"px-4 py-6 text-center text-muted-foreground",colspan:"5"},"Користувачі відсутні.",-1)])])):c("",!0)])])])]),l(s(H),{open:p.value,"onUpdate:open":e[5]||(e[5]=o=>p.value=o)},{default:a(()=>[l(s(J),null,{default:a(()=>[l(s(K),null,{default:a(()=>[l(s(Q),null,{default:a(()=>[n(u(v.value?"Редагувати користувача":"Створити користувача"),1)]),_:1})]),_:1}),t("form",{class:"mt-4 grid gap-4",onSubmit:L(N,["prevent"])},[t("div",de,[l(s(x),null,{default:a(()=>[...e[14]||(e[14]=[n("Ім'я",-1)])]),_:1}),l(s(w),{modelValue:s(r).name,"onUpdate:modelValue":e[0]||(e[0]=o=>s(r).name=o)},null,8,["modelValue"]),s(r).errors.name?(i(),m("span",ne,u(s(r).errors.name),1)):c("",!0)]),t("div",ie,[l(s(x),null,{default:a(()=>[...e[15]||(e[15]=[n("Email",-1)])]),_:1}),l(s(w),{modelValue:s(r).email,"onUpdate:modelValue":e[1]||(e[1]=o=>s(r).email=o),type:"email"},null,8,["modelValue"]),s(r).errors.email?(i(),m("span",ue,u(s(r).errors.email),1)):c("",!0)]),t("div",me,[l(s(x),null,{default:a(()=>[...e[16]||(e[16]=[n("Роль",-1)])]),_:1}),O(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>s(r).role=o),class:"h-9 rounded-md border border-input bg-transparent px-3 text-sm"},[...e[17]||(e[17]=[t("option",{value:"user"},"Користувач",-1),t("option",{value:"accountant"},"Бухгалтер",-1),t("option",{value:"admin"},"Адміністратор",-1)])],512),[[P,s(r).role]]),s(r).errors.role?(i(),m("span",pe,u(s(r).errors.role),1)):c("",!0)]),t("div",fe,[l(s(x),null,{default:a(()=>[...e[18]||(e[18]=[n("Пароль",-1)])]),_:1}),l(s(w),{modelValue:s(r).password,"onUpdate:modelValue":e[3]||(e[3]=o=>s(r).password=o),type:"password",placeholder:v.value?"Залиште порожнім, щоб не змінювати":""},null,8,["modelValue","placeholder"]),s(r).errors.password?(i(),m("span",ce,u(s(r).errors.password),1)):c("",!0)]),t("div",ve,[l(s(f),{type:"button",variant:"ghost",onClick:e[4]||(e[4]=o=>p.value=!1)},{default:a(()=>[...e[19]||(e[19]=[n("Скасувати",-1)])]),_:1}),l(s(f),{type:"submit",disabled:s(r).processing},{default:a(()=>[...e[20]||(e[20]=[n("Зберегти",-1)])]),_:1},8,["disabled"])])],32)]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{Be as default};
